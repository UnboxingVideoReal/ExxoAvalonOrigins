using Microsoft.Xna.Framework;using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;using Terraria;using Terraria.ModLoader;using Terraria.ID;using Terraria.Localization;namespace ExxoAvalonOrigins.Projectiles{	public class TrifectalBall2 : ModProjectile	{		public override void SetStaticDefaults()		{			DisplayName.SetDefault("Trifectal Ball");		}		public override void SetDefaults()		{			Rectangle dims = ExxoAvalonOrigins.getDims("Projectiles/TrifectalBall2");			projectile.width = dims.Width * 34 / 38;			projectile.height = dims.Height * 34 / 38 / Main.projFrames[projectile.type];			projectile.aiStyle = -1;			projectile.friendly = true;			projectile.penetrate = -1;			projectile.melee = true;			projectile.light = 0.6f;			projectile.ignoreWater = true;			projectile.tileCollide = true;		}		public override void AI()		{			if (projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().master == -1)			{				return;			}			var projectile3 = (projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().master == -2) ? null : Main.projectile[projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().master];			var vector77 = Main.player[projectile.owner].Center;			var connectedPointVelocity = Main.player[projectile.owner].velocity;			if (projectile3 == null || !projectile3.active)			{				if (Main.myPlayer == projectile.owner && projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().master != -2)				{					projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().SetMaster(projectile, new object[]					{						-2,						12					});					if (Main.netMode != NetmodeID.SinglePlayer)					{						NetMessage.SendData(78, -1, -1, NetworkText.FromLiteral(""), projectile.whoAmI, -2f, 12f, 0f, 0);					}				}				projectile.ai[0] = 1f;				projectile.tileCollide = false;			}			else if (projectile3 != null && projectile3.active)			{				vector77 = projectile3.Center;				connectedPointVelocity = projectile3.velocity;			}			if (Main.player[projectile.owner] == null || !Main.player[projectile.owner].active || Main.player[projectile.owner].dead)			{				projectile.Kill();				return;			}			Main.player[projectile.owner].itemAnimation = 10;			Main.player[projectile.owner].itemTime = 10;			if (Main.myPlayer == projectile.owner && projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().master == -2 && Vector2.Distance(projectile.Center, vector77) <= 15f)			{				projectile.Kill();			}			if (projectile.active)			{				projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().AIFlail(projectile, ref projectile.ai, vector77, connectedPointVelocity, Main.player[projectile.owner].meleeSpeed, true, 40f);				if (projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().master != -2 && projectile.ai[0] == 1f)				{					if (Math.Abs(projectile3.velocity.X) <= 0.025f)					{						projectile.velocity.X = projectile.velocity.X * 0.8f;					}					if (Math.Abs(projectile3.velocity.Y) <= 0.025f)					{						projectile.velocity.Y = projectile.velocity.Y * 0.8f;						return;					}				}			}		}	}}