using Microsoft.Xna.Framework;using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;using Terraria;using Terraria.ModLoader;using Terraria.ID;using Terraria.Localization;namespace ExxoAvalonOrigins.Projectiles{	public class TrifectalBall : ModProjectile	{		public override void SetStaticDefaults()		{			DisplayName.SetDefault("Trifectal Ball");		}		public override void SetDefaults()		{			Rectangle dims = ExxoAvalonOrigins.getDims("Projectiles/TrifectalBall");			projectile.width = dims.Width * 34 / 38;			projectile.height = dims.Height * 34 / 38 / Main.projFrames[projectile.type];			projectile.aiStyle = -1;			projectile.friendly = true;			projectile.penetrate = -1;			projectile.melee = true;			projectile.light = 0.6f;			projectile.ignoreWater = true;			projectile.tileCollide = true;		}		public override void AI()		{			projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().AIFlail(projectile, ref projectile.ai, false, 200f);			if (Main.myPlayer == projectile.owner && projectile.active && projectile.ai[0] == 1f)			{				if (!projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().firedBalls)				{					projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().firedBalls = true;					var num976 = 10f;					for (var num977 = 0; num977 < ExxoAvalonOriginsGlobalProjectile.balls.Length; num977++)					{						var value30 = (num977 == 0) ? new Vector2(12f, 0f) : ((num977 == 1) ? new Vector2(-6f, 12f) : new Vector2(-6f, -12f));						var vector78 = ExxoAvalonOriginsGlobalProjectile.RotateVector(projectile.Center, projectile.Center + value30, ExxoAvalonOriginsGlobalProjectile.RotationTo(Main.player[projectile.owner].Center, projectile.Center));						var num978 = vector78.X - projectile.Center.X;						var num979 = vector78.Y - projectile.Center.Y;						var num980 = (float)Math.Sqrt(num978 * num978 + num979 * num979);						num980 = num976 / num980;						num978 *= num980;						num979 *= num980;                        ExxoAvalonOriginsGlobalProjectile.balls[num977] = Projectile.NewProjectile(projectile.Center.X, projectile.Center.Y, num978, num979, ModContent.ProjectileType<TrifectalBall2>(), projectile.damage, projectile.knockBack, projectile.owner, 0f, 0f);					}				}				if (projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().setMasterDelay != -1)				{					projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().setMasterDelay--;				}				if (projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().setMasterDelay == 0)				{					projectile.GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().setMasterDelay = -1;					for (var num981 = 0; num981 < ExxoAvalonOriginsGlobalProjectile.balls.Length; num981++)					{						var num982 = ExxoAvalonOriginsGlobalProjectile.balls[num981];						Main.projectile[num982].GetGlobalProjectile<ExxoAvalonOriginsGlobalProjectileInstance>().SetMaster(projectile, new object[]						{							projectile.whoAmI,							num981						});						NetMessage.SendData(78, -1, -1, NetworkText.FromLiteral(""), num982, projectile.whoAmI, num981, 0f, 0);						Main.projectile[num982].netUpdate = true;					}					return;				}			}		}	}}